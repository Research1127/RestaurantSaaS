# Supabase Integration & Database Migration Documentation

## 1️⃣ Create a Supabase Account

Go to https://supabase.com￼

Click Sign Up and create your account.

Create a new project:

- Enter Project Name
- Select Database Password (save this securely)
- Choose Region

---

## 2️⃣ Get Supabase Connection String

In your Supabase dashboard, open your project.

Go to Settings → Database → Connection String

Copy details:

```yaml
Host: <your-host>
Port: 5432
Database: <your-database>
User: <your-username>
Password: <your-password>
```

Save them securely for your project.

---

## 3️⃣ Adjust Connection String in ASP.NET Core

Open appsettings.Development.json (or appropriate environment config).

Update your connection string:

```csharp
"ConnectionStrings": {
  "RestaurantsDbConn": "Host=<your-host>;Port=5432;Database=<your-database>;Username=<your-username>;Password=<your-password>"
}
```

Save the file.

---

## 4️⃣ Check Connection to Supabase

Open Terminal or psql CLI.

Test connection:

```shell
psql -h <your-host> -U <your-username> -d <your-database>

```

---

## 5️⃣ Apply Database Updates (EF Migrations) in IDE

Open your IDE (Visual Studio, Rider, etc.)

Run the following command in Package Manager Console:

```shell
dotnet ef database update

```

This will apply all pending EF migrations to your Supabase database

Ensures schema matches your local development environment

---

## 6️⃣ Generate Data Dump from Local Database (Exclude EF Migrations Table)

In terminal, run:

```shell
pg_dump \
-h localhost \
-p 5432 \
-U <local-username> \
-d <local-database> \
-F c \
--data-only \
--exclude-table=__EFMigrationsHistory \
-f backup_data_only.dump
```

This creates a .dump file with all your data except EF migrations history.

---

## 7️⃣ Restore Dump to Supabase (Exclude EF Migrations Table)

In terminal, run:

```shell
pg_restore \
-h <supabase-host> \
-p 5432 \
-U <supabase-username> \
-d <supabase-database> \
--data-only \
--no-owner \
--role=<supabase-username> \
backup_data_only.dump

```

This restores your local data into Supabase

EF migrations table is excluded, avoiding duplicate key errors
