# SWAGGER SUPPORT OF IDENTITY

### Program.cs
In Program.cs make sure these exist:

- `builder.Services.AddEndpointsApiExplorer();`
- `builder.Services.AddSwaggerGen();`

### **builder.Services.AddEndpointsApiExplorer()**

ðŸ‘‰ Purpose

It allows Swagger to discover Minimal API endpoints, including:
- MapGet(...)
- MapPost(...)
- MapIdentityApi<User>()

Without this line:

âŒ Swagger will NOT show your /login, /register, /refresh endpoints
Even though they still work.


### **builder.Services.AddSwaggerGen()**
ðŸ‘‰ Purpose

Registers Swagger generator that:
- Builds OpenAPI spec
- Generates endpoint documentation
- Enables Swagger UI

### Enable bearer token in Swagger

Extend AddSwaggerGen to support JWT Bearer authentication:

```csharp
builder.Services.AddSwaggerGen(c =>
{
    c.AddSecurityDefinition("bearerAuth", new OpenApiSecurityScheme
    {
        Type = SecuritySchemeType.Http,
        Scheme = "bearer",
    });
    c.AddSecurityRequirement(new OpenApiSecurityRequirement
    {
        {
            new OpenApiSecurityScheme
            {
                Reference = new OpenApiReference { Type = ReferenceType.SecurityScheme, Id = "bearerAuth" }
            },
            []
        }
    });
});
```

## Add Prefix for Identity Endpoints

### Program.cs

Group Identity endpoints under /api/identity:

```csharp
app.MapGroup("api/identity").MapIdentityApi<User>();
```
Now endpoints become:
- /api/identity/login
- /api/identity/register

---
### Test in Swagger
```text
1. Click Authorize 
2. Enter token value (example: 123)
```


Then call any protected API endpoint, the result will show you the `Authorization : Bearer 123`

```json
curl -X 'GET' \
  'http://localhost:5204/api/restaurants' \
  -H 'accept: */*' \
  -H 'Authorization: Bearer 123'
```

